{% set version = "1.1.alpha17" %}
{% set sha256 = "3dc8e20fa8642d01daadde5bf9e36df2c180abec8f85c0b2f296f7852b63537c" %}  # [linux]
{% set sha256 = "db1ac64e1bc9b4d24d17ee2e388c061c283ca9fbec075e022bdeaad1adc6d41c" %}  # [osx]

package:
  name: pplacer
  version: '{{ version }}'

source:
  url: https://github.com/matsen/pplacer/releases/download/v{{ version }}/pplacer-linux-v{{ version }}.zip  # [linux]
  url: https://github.com/matsen/pplacer/releases/download/v{{ version }}/pplacer-Darwin-v{{ version }}.zip  # [osx]
  sha256: '{{ sha256 }}'

build:
  skip: True  # [linux]
  number: 3
  run_exports:
    - {{ pin_subpackage('pplacer', max_pin="x") }}

requirements:
  build:
    - gsl  # [osx]
    - zlib  # [osx]
    - libsqlite  # [osx]
  host:
    - gsl  # [osx]
    - zlib  # [osx]
    - libsqlite  # [osx]
  run:
    - gsl  # [osx]
    - zlib  # [osx]
    - libsqlite  # [osx]

test:
  commands:
    - echo "nur ein Test"
    - otool -L $PREFIX/bin/pplacer
    - $PREFIX/bin/pplacer --help || true
    - ls -la $PREFIX/stefan || true
    - cat $PREFIX/stefan || true
    - pplacer --help 
#    - otool -L pplacer || true  # can't find pplacer
#    - otool -L `which pplacer`  # works and findes pplacer in /opt/mambaforge/envs/bioconda/conda-bld/pplacer_1732607090723/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_p/bin/pplacer

#    - find /usr/ -type f -name "*gsl*" || true  # [osx]
#    - find /opt/ -type f -name "*gsl*" || true  # [osx]
#    - guppy to_csv --help > /dev/null
#    - rppr check --help > /dev/null

about:
  home: http://matsen.fredhutch.org/pplacer/
  license: GPL-3.0
  license_family: GPL
  summary: Pplacer places query sequences on a fixed reference phylogenetic tree to
    maximize phylogenetic likelihood or posterior probability according to a reference
    alignment.
  dev_url: https://github.com/matsen/pplacer/

extra:
  skip-lints:
    - should_be_noarch_generic
